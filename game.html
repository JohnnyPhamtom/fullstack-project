<!--
  (TODO)
  1. When there are four answers on the screen, input form is disabled and 
     allow user match avatar to answer and generate a list of object 
     representing the user's answer. 

  2. Figure out transition of two states of the game.
-->


<!--
  (Basic thoughts for front-end design)

  In-game interface design:
  +-----------------------------------------------+
  |             |                                 |
  |             |                                 |
  |  Game Logo  |                                 |    <---- The list for players' answers
  |Players Info |         Players' answers        |          Avatars are displayed on the left, answers to the right
  |             |                                 |
  |             |                                 |
  |  Personal   |_________________________________|                                
  |   Points    | > ......                 | ==>> |    <---- Players' answer input (for 3 of 4 players) 
  +-----------------------------------------------+          / confirm matching (answers to players) (for the rest one player)


  Game process:
    Players role: 4 players, one for matching answers, the others fill in the sentence in the card
    For each round, the process is divided into two stage:

      The first stage: those 3 players enter the answers and then display the answers on the screen;
      the answers are visible for those 3 players, invisible for the one who matches the answers to players.
      When all 3 players submit answers, goto teh second stage.

      The second stage: The answers' order are shuffled. Then the answers become visible to everyone,
      that one player matches the answers to players (in some way, I'm still thinking about...) and after that
      compare the matching result to the correct answers. 

  Front Back end communication:
    During the first stage, one player submit an answer, frontend shall emit an event that send an object
    {playerID: '...', answer: '...'} to backend, backend stores that object into a list []. When there are 
    three object in that list, backend emits an event to frontend to indicate that it's time for second stage.

    During the second stage, the player match the answers and then send an list [{playerID, answer}, {playerID, answer}, ...]
    and compare to the previous list stored in the back end. 

  Some ideas for "Room":
    Either static or dynamic way is fine, depends on the backend implementation. Here is a little bit my ideas:
      Maintain a counter which works as a roomid generator: start at 1.
        If someone create a room, assign current id to that room and the counter increment one. 
      Maintain a list to store each room's information, in the same time, the index of the list is the roomid
      [{
        roomid: ...,
        owner: ..., // owner's id
        players: [],
        players_answers: [], // as mentioned in the first stage
        player_matched: [], // as mentioned in the second stage
        status: ..., // waiting-players || ingame 
      }]
     
  Temporary goals:
    Mar. 5th:  frontend and backend basic functionalities for one round
    Mar. 7th:  refine & valid frontend-backend data transforming
    Mar. 12nd or 14th: implement mulitple rounds & refine user interface
    Mar. 19th:  testing and validation


-->

<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <title>The game of things</title>

    <style>
      #cards {
        list-style-type: none; 
        margin: 0; 
        padding: 0;
      }

      #cards li { 
        padding: 5px 10px; 
      }

      .card-container {
        position: relative;
        border: solid;
        height: 50px;
        width: 200px;
        margin-bottom: 2px;
      }

      .lists-container {
        position: relative;
        margin: 0%;
      }

      .avatar-list-container {
        position: relative;
        border: solid;
        width: 20%;
        top: 1%;
        overflow: hidden;
      }

      .answer-list-container {
        position: absolute;
        border: solid;
        width: 50%;
        top: 1%;
        left: 21%;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <card-window
        v-bind:users="submittedUsers"
        v-bind:answers="submittedAnswers"></card-window>
      <input-form
        v-on:submit-answer="submitAnswer"></input-form>
    </div>
  </body>
  <script type="text/javascript">
    Vue.component('avatar-list', {
      props: ['avatar'],
      template: '\
        <div>\
          <p>\
            {{ avatar.username }}\
          </p>\
        </div>\
      '
    });

    Vue.component('answer-list', {
      props: ['answer'],
      template: '\
        <div>\
          <p>\
            {{ answer.useranswer }}\
          </p>\
        </div>\
      '
    })

    Vue.component('input-form', {
      props: ['input_msg'],
      template: '\
        <div>\
          <br>\
          <p>\
            {{ user.username }}\'s answer for the question is {{ user.userinput }}\
          </p>\
          <input id=\"username-input\" v-model=\"user.username\">\
          <input id=\"answer-input\" v-model=\"user.userinput\">\
          <button v-on:click=\"$emit(\'submit-answer\', user)\">\
            Enter\
          </button>\
        </div>\
      ',
      data: function() {
        return {
          user: {
            username: '',
            userinput: ''
          }
        };
      }
    });

    Vue.component('card-window', {
      props: ['users', 'answers'],
      template: '\
        <div id="lists-container">\
        \
          <div class="avatar-list-container">\
            <ul id="avatars">\
              <avatar-list\
                v-for="avatar in users"\
                v-bind:avatar="avatar"\
              ></avatar-list>\
            </ul>\
          </div>\
        \
          <div class="answer-list-container">\
            <ul id="answers">\
              <answer-list\
                v-for="answer in answers"\
                v-bind:answer="answer"\
              ></answer-list>\
            </ul>\
          </div>\
        \
        </div>\
      ',
    });

    let app = new Vue({
      el: '#app',
      data: {
        submittedUsers: [
          {username: 'play1'},
          {username: 'play2'},
          {username: 'play3'},
        ],
        submittedAnswers: [
          {useranswer: 'answer1'},
          {useranswer: 'answer2'},
          {useranswer: 'answer3'},
        ],
        input_msg: ''
      },
      methods: {
        submitAnswer: function(answer) {
          this.submittedUsers.push({username: answer.username});
          this.submittedAnswers.push({useranswer: answer.userinput});
        }
      } 
    }); 

    // test something like server object which is outside the Vue component
    let socketdata1 = {
      username: 'from server 1',
      useranswer: 'from server answer 1'
    }

    let socketdata2 = {
      username: 'from server 2',
      useranswer: 'from server answer 2'
    }

    // pretend to receiving data from backend
    app.submittedUsers
      .push({username: socketdata1.username});

    app.submittedAnswers
      .push({useranswer: socketdata1.useranswer});

    app.submittedUsers
      .push({username: socketdata2.username});

    app.submittedAnswers
      .push({useranswer: socketdata2.useranswer});

  </script>
</html>